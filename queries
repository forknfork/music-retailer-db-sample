--Which tracks appeared in the most playlists? How many playlists did they appear in?

SELECT tracks.name, COUNT(DISTINCT PlaylistId) as '# of Playlists'
FROM tracks
JOIN playlist_track
	ON tracks.TrackID = playlist_track.TrackId
GROUP BY tracks.TrackId
ORDER BY 2 DESC
LIMIT 40;

-- Which Which track generated the most revenue?

SELECT tracks.Name, SUM(invoice_items.UnitPrice) as 'Total Revenue'
FROM tracks
JOIN invoice_items
	ON tracks.TrackId = invoice_items.TrackId
GROUP BY tracks.TrackId
ORDER BY 2 DESC
LIMIT 40;

--Which album generated the most revenue?

SELECT albums.Title, SUM(invoice_items.UnitPrice) as 'Total Revenue'
FROM tracks
JOIN invoice_items
	ON tracks.TrackId = invoice_items.TrackId
	JOIN albums
		ON tracks.AlbumID = albums.ALbumID
GROUP BY albums.AlbumID
ORDER BY 2 DESC
LIMIT 10;

--Which genre generated the most revenue?

SELECT genres.name, ROUND(SUM(invoice_items.UnitPrice),2) as 'Total Revenue'
FROM tracks
JOIN invoice_items
	ON tracks.TrackId = invoice_items.TrackId
	JOIN genres
		ON tracks.GenreID = genres.GenreId
GROUP BY genres.GenreID
ORDER BY 2 DESC
LIMIT 10;

--Which countries have the highest sales revenue?

SELECT BillingCountry, SUM(Total) AS 'Total Revenue'
FROM invoices
GROUP BY BillingCountry
ORDER BY 2 DESC;
